{% load i18n %}
{% load sort %}

<div class="page-header">
  <div class="col-xs-2">
      <i class="icon-menu" id="toggle-sidebar"></i>
  </div>
  <div class="col-xs-6 text-center">
      <h1>{% trans "Comments" %}</h1>
  </div>
  <div class="col-xs-4 text-right">
      <div class="btn-group">
        <button type="button" class="btn btn-sm btn-info dropdown-toggle" data-toggle="dropdown">
          {{ comments_filter }} <span class="caret"></span>
        </button>
        <ul data-comments-filter class="dropdown-menu" role="menu">
          {% if comments_filter == 'Active' %}
          <li class="active"><a>{% trans "Active" %}</a></li>
          {% else %}
          <li><a href="{{ comments_url_for_filter }}&archived=False&removed=None">{% trans "Active" %}</a></li>
          {% endif %}
          {% if comments_filter == 'Hidden' %}
          <li class="active"><a>{% trans "Hidden" %}</a></li>
          {% else %}
          <li><a href="{{ comments_url_for_filter }}&archived=None&removed=True">{% trans "Hidden" %}</a></li>
          {% endif %}
          {% if comments_filter == 'Archived' %}
          <li class="active"><a>{% trans "Archived" %}</a></li>
          {% else %}
          <li><a href="{{ comments_url_for_filter }}&archived=True&removed=None">{% trans "Archived" %}</a></li>
          {% endif %}
        </ul>
      </div>
      <button type="button" class="btn btn-sm" data-export-start-url="{% url 'comments-csv' request.instance.url_name %}?{{ comments_params }}"><i class="icon-export"></i>{% trans "Export All" %}</button>
  </div>
</div> <!--END OF PAGE HEADER -->

<div class="content">
  {% if comments %}
  <div class="comments">
    <div class="row comment-table">
      <div class="col-lg-12">
        <table class="table admin-table">
          <thead>
            <tr>
              <th class="selector">
                <div class="btn-group">
                  <input type="checkbox" data-toggle-all>
                  <button data-comment-batch-dropdown type="button" class="btn dropdown-toggle" data-toggle="dropdown"><i class="icon-down-dir"></i></button>
                  <ul class="dropdown-menu" role="menu" data-batch-action>
                    <li><a href="{% url 'hide-comments' request.instance.url_name %}?{{ comments_params }}">{% trans "Hide" %}</a></li>
                    <li><a href="{% url 'show-comments' request.instance.url_name %}?{{ comments_params }}">{% trans "Unhide" %}</a></li>
                    <li><a href="{% url 'archive-comments' request.instance.url_name %}?{{ comments_params }}">{% trans "Archive" %}</a></li>
                    <li><a href="{% url 'unarchive-comments' request.instance.url_name %}?{{ comments_params }}">{% trans "Unarchive" %}</a></li>
                    <li><a href="{% url 'hide-comment-flags' request.instance.url_name %}?{{ comments_params }}">{% trans "Unflag" %}</a></li>
                  </ul>
                </div>
              </th>
              <th data-comments-sort>
                <a href="{{ comments_url_for_sort }}&sort={{ 'id'|reverse_if_current:comments_sort }}">{% trans "ID" %}</a>
              </th>
              <th data-comments-sort>
                <a href="{{ comments_url_for_sort }}&sort={{ 'visible_flag_count'|reverse_if_current:comments_sort }}">{% trans "Flag" %}</a>
              </th>
              <th data-comments-sort>
                <a href="{{ comments_url_for_sort }}&sort={{ 'user__username'|reverse_if_current:comments_sort }}">{% trans "Comment" %}</a>
              </th>
              <th class="actions">{% trans "Actions" %}</th>
              <th class="date" data-comments-sort>
                <a href="{{ comments_url_for_sort }}&sort={{ 'submit_date'|reverse_if_current:comments_sort }}">{% trans "Date" %}</a>
              </th>
            </tr>
          </thead>
          <tbody>
          {% for comment in comments %}
            {% include 'otm_comments/partials/moderation_row.html' %}
          {% endfor %}
          </tbody>
        </table> <!--END OF TABLE -->
      </div> <!--END OF TABLE COL-12 SECTION -->
    </div> <!--END OF COMMENT TABLE -->

    {% include 'treemap/partials/paging_controls.html' with paging=comments url=comments_url_for_pagination %}

    {% else %}
    <div class="alert alert-info">
      {% blocktrans %}There are no {{ comments_filter_trans }} comments.{% endblocktrans %}
    </div>
    {% endif %}
  </div> <!--END OF COMMENT AREA -->
</div>
